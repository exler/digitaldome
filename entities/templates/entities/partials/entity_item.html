{% load dome_tags entities %}
{# AIDEV-NOTE: Entity card component with neobrutalist design and colored border accent. Shows tracking status badges. #}
<div class="w-40 h-full flex flex-col">
    <div class="relative flex-1 flex flex-col">
        {# Colored border offset for neobrutalist effect #}
        <div class="absolute right-0 top-0 bottom-0 w-1.5 translate-x-full" style="background-color: {{ entity.COLOR }}"></div>
        <div class="absolute left-0 bottom-0 right-0 h-1.5 translate-y-full" style="background-color: {{ entity.COLOR }}"></div>

        {# Main card with thick black border #}
        <div class="border-3 border-black relative bg-white flex-1 flex flex-col">
        {# Image container #}
        <div class="relative aspect-[2/3] bg-neutral-200">
            <img src="{{ entity.image|imageurl }}"
                 alt="{{ entity.name }}"
                 class="w-full h-full object-cover" />

            {# Status badges in top-right corner #}
            {% if entity.tracking_status == 2 %}
                {# Completed - Green checkmark #}
                <div class="absolute top-2 right-2 w-6 h-6 bg-neo-green border-2 border-black flex items-center justify-center">
                    <svg class="w-4 h-4 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                    </svg>
                </div>
            {% elif entity.tracking_status == 0 %}
                {# Planned - Eye icon #}
                <div class="absolute top-2 right-2 w-6 h-6 bg-neo-yellow border-2 border-black flex items-center justify-center">
                    <svg class="w-4 h-4 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                </div>
            {% elif entity.tracking_status == 1 %}
                {# In Progress - Play button #}
                <div class="absolute top-2 right-2 w-6 h-6 bg-neo-pink border-2 border-black flex items-center justify-center">
                    <svg class="w-4 h-4 text-black" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                </div>
            {% elif entity.tracking_status == 3 %}
                {# Dropped - Thumbs down #}
                <div class="absolute top-2 right-2 w-6 h-6 bg-gray-400 border-2 border-black flex items-center justify-center">
                    <svg class="w-4 h-4 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10 14H5.236a2 2 0 01-1.789-2.894l3.5-7A2 2 0 018.736 3h4.018a2 2 0 01.485.06l3.76.94m-7 10v5a2 2 0 002 2h.096c.5 0 .905-.405.905-.904 0-.715.211-1.413.608-2.008L17 13V4m-7 10h2m5-10h2a2 2 0 012 2v6a2 2 0 01-2 2h-2.5" />
                    </svg>
                </div>
            {% elif entity.tracking_status == 4 %}
                {# On Hold - Pause button #}
                <div class="absolute top-2 right-2 w-6 h-6 bg-neo-purple border-2 border-black flex items-center justify-center">
                    <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z" />
                    </svg>
                </div>
            {% endif %}
        </div>

        {# Content section with black background #}
        <div class="bg-black text-white p-2 space-y-1 flex-1 flex flex-col justify-start">
            {# Entity type badge #}
            <div class="inline-block">
                <span class="badge text-black"
                      style="background-color: {{ entity.COLOR }};">
                    {{ entity|verbosename }}
                </span>
            </div>

            {# Entity title #}
            <h3 class="text-xs font-bold line-clamp-2">{{ entity.name }}</h3>
        </div>

        {# Clickable overlay #}
        <a href="{% url 'entities:entities-detail' entity|verbosename entity.id %}"
           class="absolute inset-0 z-10"
           aria-label="View {{ entity.name }}"></a>
        </div>
    </div>
</div>
